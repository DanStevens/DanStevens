<!DOCTYPE html>
<!-- Version: 1.7; Author: Dan Stevens <dan.stevens@oracle.com> -->
<html>
<head>
  <title>Oracle Service Cloud Site Links</title>
  <link rel="icon" href="OracleFavicon.png">
  <style>
    body {
      font: 10pt arial, helvetica, sans-serif;
    }
    #inputForm {
      margin-bottom: 20px;
    }
    #inputForm input
    {
      width: 180px;
    }
    #inputForm p {
      float: left;
      margin-right: 20px;
    }
    .outputTable {
      width: 100%;
    }
    .outputTable input {
      width: 100%;
    }
    .outputTable tr td:first-child { 
      width: 300px;
    }
    
    /* Clearfix */
    .cf:before,
    .cf:after {
      content: " ";
      display: table;
    }
    .cf:after {
      clear: both;
    }
    /* For IE 6/7 only */
    .cf {
      zoom: 1;
    }
  </style>
  <script>    
    // Cross-browser trim support
    if(!String.prototype.trim) {
      String.prototype.trim = function () {
        return this.replace(/^\s+|\s+$/g,'');
      };
    }

    // Escapes a string for Regular Expressions. See https://stackoverflow.com/a/6969486/660896
    function escapeRegExp(str) {
      return str.replace(/[\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g, "\\$&");
    }
    
    // Globals
    var p = 'https://';
    var podDomain;
    var siteNameInput;
    var intfNameInput;
    var virtualHostInput;
    var baseUriOutput;
    var baseUriAnchor;
    var cpRootAnchor;
    var cpRootOutput;
    var cpHomeAnchor;
    var cpHomeOutput;
    var cpAdminAnchor;
    var cpAdminOutput;
    var launchPageOutput;
    var launchPageAnchor;
    var scriptsRootOutput;
    var scriptsRootAnchor;
    var accessOutput;
    var accessAnchor;
    var restApiAnchor;
    var restApiOutput;
    var connectApiOutput;
    var connectApiAnchor;
    var kfApiOutput;
    var kfApiAnchor;
    var chatApiOutput;
    var chatApiAnchor;
    var aug17_connectApiOutput;
    var aug17_connectApiAnchor;
    var aug17_kfApiOutput;
    var aug17_kfApiAnchor;
    var aug17_chatApiOutput;
    var aug17_chatApiAnchor;
    var launchArgsOutput;
    var cpAdminUrlRegexOutput;
    var kaContentApiRootOutput;
    var kaContentApiRootAnchor;
    var kaSearchApiRootOutput;
    var kaSearchApiRootAnchor;
    
    function domLoad() {
    
      // Inputs
      podDomainSelect = document.getElementById('podDomainSelect');
      siteNameInput = document.getElementById('siteNameInput');
      intfNameInput = document.getElementById('intfNameInput');
      virtualHostInput = document.getElementById('virtualHostInput');
      
      // Set Input values according to URL parameters, if present
      var siteParam = getUrlParameterByName('site');
      if (siteParam)
        siteNameInput.value = siteParam;
      var intfParam = getUrlParameterByName('intf');
      if (intfParam)
        intfNameInput.value = intfParam;
      var hostParam = getUrlParameterByName('host'); 
      if (hostParam)
        virtualHostInput.value = hostParam;
      
      // Resource URLs
      baseUriOutput = document.getElementById('baseUriOutput');
      baseUriAnchor = document.getElementById('baseUriAnchor');
      cpRootOutput = document.getElementById('cpRootOutput');
      cpRootAnchor = document.getElementById('cpRootAnchor');
      cpHomeOutput = document.getElementById('cpHomeOutput');
      cpHomeAnchor = document.getElementById('cpHomeAnchor');
      cpAdminOutput = document.getElementById('cpAdminOutput');
      cpAdminAnchor = document.getElementById('cpAdminAnchor');
      launchPageOutput = document.getElementById('launchPageOutput');
      launchPageAnchor = document.getElementById('launchPageAnchor');
      installerOutput = document.getElementById('installerOutput');
      installerAnchor = document.getElementById('installerAnchor');
      scriptsRootOutput = document.getElementById('scriptsRootOutput');
      scriptsRootAnchor = document.getElementById('scriptsRootAnchor');
      accessOutput = document.getElementById('accessOutput');
      accessAnchor = document.getElementById('accessAnchor');
      restApiOutput = document.getElementById('restApiOutput');
      restApiAnchor = document.getElementById('restApiAnchor');
      
      // Legacy SOAP URLs
      connectApiOutput = document.getElementById('connectApiOutput');
      connectApiAnchor = document.getElementById('connectApiAnchor');
      connectApi1_2Output = document.getElementById('connectApi1_2Output');
      connectApi1_2Anchor = document.getElementById('connectApi1_2Anchor');
      kfApiOutput = document.getElementById('kfApiOutput');
      kfApiAnchor = document.getElementById('kfApiAnchor');
      chatApiOutput = document.getElementById('chatApiOutput');
      chatApiAnchor = document.getElementById('chatApiAnchor');
      
      // August 2017+ SOAP URLs
      aug17_connectApiOutput = document.getElementById('aug17_connectApiOutput');
      aug17_connectApiAnchor = document.getElementById('aug17_connectApiAnchor');
      aug17_connectApi1_3Output = document.getElementById('aug17_connectApi1_3Output');
      aug17_connectApi1_3Anchor = document.getElementById('aug17_connectApi1_3Anchor');
      aug17_kfApiOutput = document.getElementById('aug17_kfApiOutput');
      aug17_kfApiAnchor = document.getElementById('aug17_kfApiAnchor');
      aug17_chatApiOutput = document.getElementById('aug17_chatApiOutput');
      aug17_chatApiAnchor = document.getElementById('aug17_chatApiAnchor');
      
      // Other Resources
      launchArgsOutput = document.getElementById('launchArgsOutput');
      cpAdminUrlRegexOutput = document.getElementById('cpAdminUrlRegexOutput');
      
      // Knowledge Advanced REST API
      kaContentApiRootOutput = document.getElementById('kaContentApiRootOutput');
      kaContentApiRootAnchor = document.getElementById('kaContentApiRootAnchor');
      kaSearchApiRootOutput = document.getElementById('kaSearchApiRootOutput');
      kaSearchApiRootAnchor = document.getElementById('kaSearchApiRootAnchor');
      
      updateLinks();
      
      siteNameInput.select();
      siteNameInput.focus();
    }
    
    function updateLinks() {
      var podDomain = podDomainSelect.value;
      var siteName = siteNameInput.value.trim();
      var suffix = /__.+$/.exec(siteName);
      suffix = suffix === null ? '' : suffix[0];
      var suffixDashed = suffix.replace(/_/g, '-');
      var intfName = intfNameInput.value.trim();
      var intfNameDashed = intfName.replace(/_/g, '-');
      var virtualHost = virtualHostInput.value.trim();
      var hostName = virtualHost || intfNameDashed + suffixDashed + '.' + podDomain;
      var baseUri = p + hostName + '/';
      var cpRoot = baseUri + 'app/';
      var cfg = baseUri + 'cgi-bin/' + intfName +'.cfg'
      var launchPage = cfg + '/php/admin/launch.php';
      var installer = p + 'installer-' + siteName.replace(/_/g, '-') + '.' + podDomain +
                      '/RightNow.Installer.application?launch=' + cfg + '&dbname=' + siteName +
                      '&trace=true&lang=en_GB';
      var kaContentApiRoot = p + intfNameDashed + suffixDashed + '-irs' + '.' + podDomain + '/km';
      var kaSearchApiRoot = p + intfNameDashed + suffixDashed + '-qp' + '.' + podDomain + '/srt';
      
      // Resources URLs
      baseUriAnchor.href = baseUriOutput.value = baseUri;
      cpRootAnchor.href = cpRootOutput.value = cpRoot;
      cpHomeAnchor.href = cpHomeOutput.value = cpRoot + 'home';
      cpAdminAnchor.href = cpAdminOutput.value = baseUri + 'ci/admin';
      cpAboutAnchor.href = cpAboutOutput.value = baseUri + 'ci/about';
      launchPageAnchor.href = launchPageOutput.value = launchPage;
      installerAnchor.href = installerOutput.value = installer;
      scriptsRootAnchor.href = scriptsRootOutput.value = cfg + '/php/custom/';
      accessAnchor.href = accessOutput.value = cfg + '/php/admin/session/login.php';
      restApiAnchor.href = restApiOutput.value = baseUri + 'services/rest/connect';
      
      // Legacy SOAP URLs
      connectApiAnchor.href = connectApiOutput.value = cfg + '/services/soap?wsdl=typed';
      connectApi1_2Anchor.href = connectApi1_2Output.value = cfg + '/services/soap?wsdl=typed_v1.2';
      kfApiAnchor.href = kfApiOutput.value = cfg + '/services/kf_soap?wsdl';
      chatApiAnchor.href = chatApiOutput.value = cfg + '/services/chat_soap?wsdl';
      
      // August 2017+ SOAP URLs
      aug17_connectApiAnchor.href = aug17_connectApiOutput.value =
        baseUri + 'services/soap/connect/soap?wsdl=typed';
      aug17_connectApi1_2Anchor.href = aug17_connectApi1_2Output.value =
        baseUri + 'services/soap/connect/soap?wsdl=typed_v1.3';
      aug17_kfApiAnchor.href = aug17_kfApiOutput.value = baseUri + 'services/soap/connect/kf_soap?wsdl';
      aug17_chatApiAnchor.href = aug17_chatApiOutput.value = baseUri + 'services/soap/connect/chat_soap?wsdl';
      
      // Other Resources
      launchArgsOutput.value = 'launch=' + cfg + ' dbname=' + siteName + ' isNetworkDeployed=true';
      cpAdminUrlRegexOutput.value = "https:\\/\\/" +
        (virtualHost ? escapeRegExp(virtualHost) : intfNameDashed + '(--[\\w-]*)?\\.' + escapeRegExp(podDomain)) +
        '\\/ci\\/admin.*';
      
      // Knowledge Advanced REST API
      kaContentApiRootAnchor.href = kaContentApiRootOutput.value = kaContentApiRoot;
      kaSearchApiRootAnchor.href = kaSearchApiRootOutput.value = kaSearchApiRoot;
        
    }
    
    function getUrlParameterByName(name, url) {
      if (!url) url = window.location.href;
      url = url.toLowerCase(); // This is just to avoid case sensitiveness  
      name = name.replace(/[\[\]]/g, "\\$&").toLowerCase();// This is just to avoid case sensitiveness for query parameter name
      var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
          results = regex.exec(url);
      if (!results) return null;
      if (!results[2]) return '';
      return decodeURIComponent(results[2].replace(/\+/g, " "));
    }
  </script>
</head>

<body onload="domLoad()">

<h1>Oracle Service Cloud Site Links</h1>

<p>Complete the form below and a list of resource links for the given site/interface will be shown beneath. Use underscores rather then dashes in the site name and interface name.</p>
<p>
  <b>Tip:</b> Install the <a href="https://addons.mozilla.org/en-US/firefox/addon/fxclickonce/" target="_blank">
  FxClickOnce</a> add-on to use the <i>ClickOnce Installer</i> resource in Firefox.
</p>
<p>
  <b>Tip:</b> URL query parameters <i>site</i>, <i>intf</i> and <i>host</i> can be used to set the <i>Site name</i>,
  <i>Interface name</i> and <i>Virtual Hostname</i> input elements
  (<a href="?site=foo__pro&intf=bar&host=foobar.example.com">example</a>).
</p>

<div id="podDomainContainer" class="cf">
  <p>
    Pod Domain: 
    <select id="podDomainSelect" onchange="updateLinks()">
      <option selected="selected">custhelp.com</option>
      <option>rightnowdemo.com</option>
    </select>
  </p>
</div>

<div id="inputForm" class="cf">
  <p>
    Site name (including suffix):<br/>
    <input type="text" id="siteNameInput" value="example__pro" onkeyup="updateLinks()" />
  </p>
  <p>
    Interface name:<br/>
    <input type="text" id="intfNameInput" value="example_en" onkeyup="updateLinks()" />
  </p>
  <p>
    Virtual Hostname (blank for none):<br/>
    <input type="text" id="virtualHostInput" onkeyup="updateLinks()" value=""/>
  </p>
</div>

<h2>General URLs</h2>

<table id="resourceUrlsTable" class="outputTable">
  <tbody>
    <tr>
      <td><a id="baseUriAnchor" href="#" target="_blank">Base URI</a></td>
      <td><input type="text" id="baseUriOutput" onfocus="this.select();" /></td>
    </tr>
    <tr>
      <td><a id="cpRootAnchor" href="#" target="_blank">Customer Portal root</a></td>
      <td><input type="text" id="cpRootOutput" onfocus="this.select();" /></td>
    </tr>
    <tr>
      <td><a id="cpHomeAnchor" href="#" target="_blank">Customer Portal home page</a></td>
      <td><input type="text" id="cpHomeOutput" onfocus="this.select();" /></td>
    </tr>
    <tr>
      <td><a id="cpAdminAnchor" href="#" target="_blank">Customer Portal administration</a></td>
      <td><input type="text" id="cpAdminOutput" onfocus="this.select();" /></td>
    </tr>
    <tr>
      <td><a id="cpAboutAnchor" href="#" target="_blank">Customer Portal about page</a></td>
      <td><input type="text" id="cpAboutOutput" onfocus="this.select();" /></td>
    </tr>
    <tr>
      <td><a id="launchPageAnchor" href="#" target="_blank">Launch page</a></td>
      <td><input type="text" id="launchPageOutput" onfocus="this.select();" /></td>
    </tr>
    <tr>
      <td><a id="installerAnchor" href="#" target="_blank">ClickOnce Installer</a></td>
      <td><input type="text" id="installerOutput" onfocus="this.select();" /></td>
    </tr>
    <tr>
      <td><a id="accessAnchor" href="#" target="_blank">Accessibility interface</a></td>
      <td><input type="text" id="accessOutput" onfocus="this.select();" /></td>
    </tr>
    <tr>
      <td><a id="scriptsRootAnchor" href="#" target="_blank">Custom Scripts root</a></td>
      <td><input type="text" id="scriptsRootOutput" onfocus="this.select();" /></td>
    </tr>
    <tr>
      <td><a id="restApiAnchor" href="#" target="_blank">REST API Root</a></td>
      <td><input type="text" id="restApiOutput" onfocus="this.select();" /></td>
    </tr>
  </tbody>
</table>

<h2>SOAP URLs</h2>

<h3>Legacy SOAP URLs</h3>

<table id="legacySoapUrlsTable" class="outputTable">
  <tbody>
    <tr>
      <td><a id="connectApiAnchor" href="#" target="_blank">Connect web service endpoint</a></td>
      <td><input type="text" id="connectApiOutput" onfocus="this.select();" /></td>
    </tr>
    <tr>
      <td><a id="connectApi1_2Anchor" href="#" target="_blank">Connect web service endpoint (version 1.2)</a></td>
      <td><input type="text" id="connectApi1_2Output" onfocus="this.select();" /></td>
    </tr>
    <tr>
      <td><a id="kfApiAnchor" href="#" target="_blank">Knowledge Foundation web service endpoint</a></td>
      <td><input type="text" id="kfApiOutput" onfocus="this.select();" /></td>
    </tr>
    <tr>
      <td><a id="chatApiAnchor" href="#" target="_blank">Chat web service endpoint</a></td>
      <td><input type="text" id="chatApiOutput" onfocus="this.select();" /></td>
    </tr>
  </tbody>
</table>

<h3>August 2017+ SOAP URLs</h3>

<table id="aug17_SoapUrlsTable" class="outputTable">
  <tbody>
    <tr>
      <td><a id="aug17_connectApiAnchor" href="#" target="_blank">Connect web service endpoint</a></td>
      <td><input type="text" id="aug17_connectApiOutput" onfocus="this.select();" /></td>
    </tr>
    <tr>
      <td><a id="aug17_connectApi1_2Anchor" href="#" target="_blank">Connect web service endpoint (version 1.3)</a></td>
      <td><input type="text" id="aug17_connectApi1_2Output" onfocus="this.select();" /></td>
    </tr>
    <tr>
      <td><a id="aug17_kfApiAnchor" href="#" target="_blank">Knowledge Foundation web service endpoint</a></td>
      <td><input type="text" id="aug17_kfApiOutput" onfocus="this.select();" /></td>
    </tr>
    <tr>
      <td><a id="aug17_chatApiAnchor" href="#" target="_blank">Chat web service endpoint</a></td>
      <td><input type="text" id="aug17_chatApiOutput" onfocus="this.select();" /></td>
    </tr>
  </tbody>
</table>

<h2>Other Resources</h2>

<table id="otherResourcesTable" class="outputTable">
  <tbody>
    <tr>
      <td>Launch command line arguments</td>
      <td><input type="text" id="launchArgsOutput" onfocus="this.select();" /></td>
    </tr>
    <tr>
      <td>Regex for matching CP Admin URLs</td>
      <td><input type="text" id="cpAdminUrlRegexOutput" onfocus="this.select();" /></td>
    </tr>
  </tbody>
</table>

<h2>Knowledge Advanced REST API</h2>

<p>Note: Knowledge Advanced API hostnames are seperate to the Service Cloud host name and doesn't
use Virtual Hostname.</p>
<table id="kaapiTable" class="outputTable">
  <tbody>
    <tr>
      <td><a id="kaContentApiRootAnchor" href="#" target="_blank">Content API Root URI</a></td>
      <td><input type="text" id="kaContentApiRootOutput" onfocus="this.select();" /></td>
    </tr>
    <tr>
      <td><a id="kaSearchApiRootAnchor" href="#" target="_blank">Search API Root URI</a></td>
      <td><input type="text" id="kaSearchApiRootOutput" onfocus="this.select();" /></td>
    </tr>
  </tbody>
</table>

</body>

</html>
